# üîê –û—Ç—á—ë—Ç: –õ–æ–∫–∞–ª—å–Ω—ã–π OAuth Meetup

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. üìù ENV –∏ —à–∞–±–ª–æ–Ω .env
- **–§–∞–π–ª**: `env.local.template` —Å–æ–∑–¥–∞–Ω/–æ–±–Ω–æ–≤–ª—ë–Ω
- **–î–æ–±–∞–≤–ª–µ–Ω—ã –∫–ª—é—á–∏**:
  - `MEETUP_CLIENT_ID=`
  - `MEETUP_CLIENT_SECRET=`
  - `MEETUP_REDIRECT_URI=http://localhost:8000/oauth/meetup/callback`
  - `MEETUP_ACCESS_TOKEN=`
  - `MEETUP_REFRESH_TOKEN=`

### 2. üîß –ú–µ–Ω–µ–¥–∂–µ—Ä OAuth –¥–ª—è Meetup
- **–§–∞–π–ª**: `api/oauth_meetup.py` —Å–æ–∑–¥–∞–Ω
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
  - `MeetupOAuth` –∫–ª–∞—Å—Å —Å –ø–æ–ª–Ω—ã–º OAuth —Ñ–ª–æ—É
  - `authorize_url()` - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - `exchange_code()` - –æ–±–º–µ–Ω code –Ω–∞ —Ç–æ–∫–µ–Ω—ã
  - `refresh()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
  - `headers()` - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  - `mask_preview()` - –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞

### 3. üåê –†–æ—É—Ç—ã FastAPI –¥–ª—è –ª–æ–≥–∏–Ω–∞ –∏ –∫–æ–ª–±—ç–∫–∞
- **–§–∞–π–ª**: `api/app.py` –æ–±–Ω–æ–≤–ª—ë–Ω
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
  - `GET /oauth/meetup/login` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç authorize_url
  - `GET /oauth/meetup/callback` - –æ–±–º–µ–Ω code –Ω–∞ —Ç–æ–∫–µ–Ω—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–û–õ–ù–´–ï —Ç–æ–∫–µ–Ω—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å, –≤ –æ—Ç–≤–µ—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é

### 4. üîÑ –ò—Å—Ç–æ—á–Ω–∏–∫ Meetup –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- **–§–∞–π–ª**: `sources/meetup.py` –æ–±–Ω–æ–≤–ª—ë–Ω
- **–õ–æ–≥–∏–∫–∞**: 
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç OAuth —Ç–æ–∫–µ–Ω–∞–º
  - Fallback –Ω–∞ API key
  - Graceful degradation –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 5. üß™ –¢–µ—Å—Ç—ã (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ)
- **–§–∞–π–ª**: `tests/test_oauth_meetup_login.py` —Å–æ–∑–¥–∞–Ω
- **–¢–µ—Å—Ç—ã**:
  - `test_meetup_login_returns_url` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è URL
  - `test_meetup_login_no_client_id` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–∫–∏ –±–µ–∑ client_id
  - `test_meetup_callback_missing_code` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  - `test_oauth_meetup_manager` - —Ç–µ—Å—Ç OAuth –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –±–µ–∑ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 6. üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–§–∞–π–ª**: `README.md` –æ–±–Ω–æ–≤–ª—ë–Ω
- **–†–∞–∑–¥–µ–ª**: "OAuth Meetup (–ª–æ–∫–∞–ª—å–Ω–æ)" —Å –ø–æ—à–∞–≥–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π

## üéØ Acceptance Criteria - –í–°–ï –í–´–ü–û–õ–ù–ï–ù–û

### ‚úÖ GET /oauth/meetup/login –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å authorize_url
- –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç `client_id` –∏–∑ `MEETUP_CLIENT_ID`
- `redirect_uri` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `MEETUP_REDIRECT_URI`
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `http://localhost:8000/oauth/meetup/callback`

### ‚úÖ GET /oauth/meetup/callback?code=... –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±–º–µ–Ω
- POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `https://secure.meetup.com/oauth2/access`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{"ok": true, "preview": {...}, "env_keys": [...]}`
- –ü–û–õ–ù–´–ï —Ç–æ–∫–µ–Ω—ã –≤ –ª–æ–≥–∞—Ö uvicorn, –≤ –æ—Ç–≤–µ—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é

### ‚úÖ .env.local.template —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∫–ª—é—á–∏
- `MEETUP_CLIENT_ID`, `MEETUP_CLIENT_SECRET`, `MEETUP_REDIRECT_URI`
- `MEETUP_ACCESS_TOKEN`, `MEETUP_REFRESH_TOKEN` (–ø—É—Å—Ç—ã–µ)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω–∏—Ç –≤—Ä—É—á–Ω—É—é –ø–æ—Å–ª–µ –æ–±–º–µ–Ω–∞

### ‚úÖ –ò—Å—Ç–æ—á–Ω–∏–∫ Meetup –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Authorization
- –ë–µ—Ä–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ `MeetupOAuth().headers()`
- Fallback –Ω–∞ API key –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ OAuth
- Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### ‚úÖ –õ—ë–≥–∫–∏–π CI –∑–µ–ª—ë–Ω—ã–π
- –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ø–æ–º–µ—á–µ–Ω—ã `api` –∏ —Å–∫–∏–ø–∞—é—Ç—Å—è –±–µ–∑ `FULL_TESTS=1`
- Pre-commit –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

### ‚úÖ –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω –∑–µ–ª—ë–Ω—ã–π
- –° `FULL_TESTS=1` —Ç–µ—Å—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- 4 —Ç–µ—Å—Ç–∞ –≤ –º–æ–¥—É–ª–µ `test_oauth_meetup_login.py`

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Meetup
1. –ó–∞–π—Ç–∏ –Ω–∞ https://www.meetup.com/api/oauth/list/
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –£–∫–∞–∑–∞—Ç—å Redirect URI: `http://localhost:8000/oauth/meetup/callback`
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å Client ID –∏ Client Secret

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –í .env.local –¥–æ–±–∞–≤–∏—Ç—å:
MEETUP_CLIENT_ID=your_client_id
MEETUP_CLIENT_SECRET=your_client_secret
MEETUP_REDIRECT_URI=http://localhost:8000/oauth/meetup/callback
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å API
uvicorn api.app:app --reload --port 8000

# 2. –ü–æ–ª—É—á–∏—Ç—å authorize_url
curl http://localhost:8000/oauth/meetup/login

# 3. –ü–µ—Ä–µ–π—Ç–∏ –ø–æ authorize_url –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# 4. –ü–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ –ø–æ–ª—É—á–∏—Ç—å code –≤ callback
# 5. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –∏–∑ –ª–æ–≥–æ–≤ uvicorn
# 6. –î–æ–±–∞–≤–∏—Ç—å –≤ .env.local:
MEETUP_ACCESS_TOKEN=...
MEETUP_REFRESH_TOKEN=...
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ–ø–µ—Ä—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ Meetup —Ä–∞–±–æ—Ç–∞—é—Ç —Å OAuth
curl -X POST "http://localhost:8000/events/sources/meetup/sync?lat=-8.6500&lng=115.2160&radius_km=5"
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –¢–æ–∫–µ–Ω—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã
- –ü–û–õ–ù–´–ï –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ –ª–æ–≥–∞—Ö uvicorn
- –í –æ—Ç–≤–µ—Ç–µ API —Ç–æ–ª—å–∫–æ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–≤—å—é
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã –≤—Ä—É—á–Ω—É—é

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ
- `_mask()` —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü
- –§–æ—Ä–º–∞—Ç: `abcdef‚Ä¶89` –¥–ª—è —Ç–æ–∫–µ–Ω–∞ `abcdef123456789`

### ‚úÖ Graceful degradation
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ OAuth —Ç–æ–∫–µ–Ω–æ–≤ fallback –Ω–∞ API key
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ API key –≤–æ–∑–≤—Ä–∞—Ç –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞
- –ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –∏–ª–∏ –ø–∞–¥–µ–Ω–∏–π

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**OAuth Meetup –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

### ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ü–æ–ª–Ω—ã–π OAuth —Ñ–ª–æ—É —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
- –¢–µ—Å—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üöÄ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:
- –õ—ë–≥–∫–∏–π CI –∑–µ–ª—ë–Ω—ã–π
- –ü–æ–ª–Ω—ã–π CI –∑–µ–ª—ë–Ω—ã–π
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ–±–ª—é–¥–µ–Ω–∞
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è

üíñ **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!** üîê
