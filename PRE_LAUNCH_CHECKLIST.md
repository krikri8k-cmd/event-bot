# üöÄ –ß–µ–∫-–ª–∏—Å—Ç "–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º"

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∏ —Å–æ–∑–¥–∞–Ω—ã
\d+ events

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–ª–æ–Ω–∫–∏:
-- source, external_id, url, updated_at

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–Ω–¥–µ–∫—Å—ã:
-- idx_events_coords, idx_events_starts_at
-- ux_events_source_ext (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
```

### ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
```bash
psql "$DATABASE_URL" -f migrations/add_meetup_columns.sql
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### ‚úÖ .env –∑–∞–ø–æ–ª–Ω–µ–Ω:
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
DATABASE_URL=postgresql+psycopg2://user:pass@host:port/db
TELEGRAM_TOKEN=your_bot_token

# –î–ª—è Meetup –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
MEETUP_API_KEY=your_meetup_api_key

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
GOOGLE_MAPS_API_KEY=your_google_maps_key
OPENAI_API_KEY=your_openai_key
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ CI –∑–µ–ª—ë–Ω—ã–π:
```bash
# –õ—ë–≥–∫–∏–π CI (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
pytest -m "api or db"

# –ü–æ–ª–Ω—ã–π —Ä–µ–∂–∏–º (—Å Postgres)
FULL_TESTS=1 pytest -m "api or db"

# Pre-commit
pre-commit run --all-files
```

## üîÑ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞

### ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Å—Ç–∞, –≥–¥–µ —á–∏—Ç–∞–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç `/events/nearby`:

**–ë—ã–ª–æ:**
```python
events = response.json()  # —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
```

**–°—Ç–∞–ª–æ:**
```python
data = response.json()
events = data["items"]    # —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
count = data["count"]     # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
```

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã:
- Telegram –±–æ—Ç
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –î—Ä—É–≥–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üõ†Ô∏è –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# Linux/Mac
./scripts/quick_test.sh

# Windows PowerShell
.\scripts\quick_test.ps1
```

### ‚úÖ –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API —Ä–∞–±–æ—Ç–∞–µ—Ç
curl "http://localhost:8000/health"
# –û–∂–∏–¥–∞–µ–º: {"status": "ok"}

# 2. –ò–Ω–∂–µ—Å—Ç Meetup (–µ—Å–ª–∏ –∫–ª—é—á –µ—Å—Ç—å)
curl -X POST "http://localhost:8000/events/sources/meetup/sync?lat=-8.6500&lng=115.2160&radius_km=5"
# –û–∂–∏–¥–∞–µ–º: {"inserted": N}

# 3. –ü–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ
curl "http://localhost:8000/events/nearby?lat=-8.6500&lng=115.2160&radius_km=5&limit=10"
# –û–∂–∏–¥–∞–µ–º: {"items": [...], "count": N}
```

## üîç –í–∞–ª–∏–¥–∞—Ü–∏—è

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```bash
# –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
curl "http://localhost:8000/events/nearby?lat=100&lng=0"
# –û–∂–∏–¥–∞–µ–º: 400 Bad Request

# –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ä–∞–¥–∏—É—Å
curl "http://localhost:8000/events/nearby?lat=0&lng=0&radius_km=50"
# –û–∂–∏–¥–∞–µ–º: 400 Bad Request
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
- –û—à–∏–±–∫–∏ –∏–Ω–∂–µ—Å—Ç–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç–∞–≤–æ–∫/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API
- Rate limiting —Å–æ–±—ã—Ç–∏—è

### ‚úÖ –ê–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
- –ü–∞–¥–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö API
- –í—ã—Å–æ–∫–∞—è –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!

### ‚úÖ –í—Å–µ –ø—É–Ω–∫—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
- [ ] CI –∑–µ–ª—ë–Ω—ã–π
- [ ] –ö–ª–∏–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### üéâ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω!

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ "–Ω–∞ –ø–æ—Ç–æ–º"

### 1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ DO UPDATE (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
- –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–Ω–∂–µ—Å—Ç–µ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

### 2. PostGIS/earthdistance –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä–∞–¥–∏—É—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```sql
-- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
CREATE EXTENSION IF NOT EXISTS postgis;

-- –°–æ–∑–¥–∞—Ç—å GiST –∏–Ω–¥–µ–∫—Å
CREATE INDEX idx_events_geom ON events USING GIST (ST_SetSRID(ST_MakePoint(lng, lat), 4326));
```

### 3. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∏–Ω–∂–µ—Å—Ç–∞
```python
# APScheduler –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∏–Ω–∫–∞
from apscheduler.schedulers.asyncio import AsyncIOScheduler

scheduler = AsyncIOScheduler()
scheduler.add_job(sync_meetup_job, 'interval', minutes=30)
scheduler.start()
```

### 4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- Redis –¥–ª—è –∫—ç—à–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- TTL 5-10 –º–∏–Ω—É—Ç –¥–ª—è —Å–≤–µ–∂–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

### 5. –ú–µ—Ç—Ä–∏–∫–∏
- Prometheus + Grafana
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–ª–µ—Ä—Ç—ã –Ω–∞ SLA –Ω–∞—Ä—É—à–µ–Ω–∏—è
