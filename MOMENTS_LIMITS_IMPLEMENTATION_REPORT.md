# üéØ –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã "–ú–æ–º–µ–Ω—Ç—ã" —Å –ª–∏–º–∏—Ç–∞–º–∏ v2.1

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `MOMENT_TTL_OPTIONS="30,60,120"` - –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã (–≤ –º–∏–Ω—É—Ç–∞—Ö)
- ‚úÖ `MOMENT_DAILY_LIMIT=2` - –º–∞–∫—Å–∏–º—É–º –º–æ–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–Ω—å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `MOMENT_MAX_RADIUS_KM=20` - —Ä–∞–¥–∏—É—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–º–µ–Ω—Ç–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `config.py` –¥–ª—è —á—Ç–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö Moment
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó:
  - `username` - username —Å–æ–∑–¥–∞—Ç–µ–ª—è
  - `title` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞
  - `location_lat/lng` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
  - `created_at/expires_at` - –≤—Ä–µ–º–µ–Ω–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è
  - `is_active` - —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã legacy –ø–æ–ª—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 3. –°–∏—Å—Ç–µ–º–∞ –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `check_daily_limit()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
- ‚úÖ –õ–∏–º–∏—Ç: **–Ω–µ –±–æ–ª–µ–µ 2 –º–æ–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–Ω—å** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°—á–µ—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ø–æ–ª–Ω–æ—á—å –ø–æ UTC
- ‚úÖ –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞: "‚ùå –¢—ã —É–∂–µ —Å–æ–∑–¥–∞–ª 2 –º–æ–º–µ–Ω—Ç–∞ —Å–µ–≥–æ–¥–Ω—è. –î–æ–∂–¥–∏—Å—å –∑–∞–≤—Ç—Ä–∞, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ."

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ TTL –æ–ø—Ü–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã: 30 –º–∏–Ω, 1 —á–∞—Å, 2 —á–∞—Å–∞
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (30 –º–∏–Ω, 1 —á–∞—Å, 2 —á–∞—Å–∞)

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –º–æ–¥–µ–ª–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ username —Å–æ–∑–¥–∞—Ç–µ–ª—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏ –∞–¥—Ä–µ—Å–∞

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/diag_last` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤
  - –õ–∏–º–∏—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (2/–¥–µ–Ω—å)
  - TTL –≤–∞—Ä–∏–∞–Ω—Ç—ã (30/60/120 –º–∏–Ω)
  - –î–µ—Ç–∞–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ —Å –∞–≤—Ç–æ—Ä–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º

### 7. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- ‚úÖ –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤ (`is_active = False`)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—á–∏—â–µ–Ω–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤

### 8. –¢–µ—Å—Ç—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/test_moments_limits.py`:
  - –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–æ–≤
  - –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–º–µ–Ω—Ç–æ–≤
  - –¢–µ—Å—Ç—ã –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–µ–∫—à–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤
  - –¢–µ—Å—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ TTL –æ–ø—Ü–∏–π
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

## üé® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–æ–≥–ª–∞—Å–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –¢–ó:
1. **–õ–∏–º–∏—Ç**: –Ω–µ –±–æ–ª–µ–µ 2 –º–æ–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–Ω—å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚úÖ
2. **TTL –≤–∞—Ä–∏–∞–Ω—Ç—ã**: 30/60/120 –º–∏–Ω—É—Ç ‚úÖ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**: –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç ‚úÖ
4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ª–∏–º–∏—Ç–∞—Ö ‚úÖ
5. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ ‚úÖ

### –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- `check_daily_limit(user_id)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞
- `create_moment()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ª–∏–º–∏—Ç–æ–≤
- `cleanup_expired_moments()` - –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å –ª–∏–º–∏—Ç–∞–º–∏

## üîß –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

- ‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ö–æ–¥ –±–µ–∑ –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –õ–∏–º–∏—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ TTL –æ–ø—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ
- ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã

## üöÄ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

1. **–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–º–µ–Ω—Ç–æ–≤**:
   - –°–æ–∑–¥–∞—Ç—å 2 –º–æ–º–µ–Ω—Ç–∞ - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ–∑–¥–∞—Ç—å 3-–π - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫–∞–∑ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –ª–∏–º–∏—Ç–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±—Ä–æ—Å –ª–∏–º–∏—Ç–∞ –≤ –ø–æ–ª–Ω–æ—á—å UTC

2. **TTL –æ–ø—Ü–∏–∏**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫: 30 –º–∏–Ω, 1 —á–∞—Å, 2 —á–∞—Å–∞
   - –°–æ–∑–¥–∞—Ç—å –º–æ–º–µ–Ω—Ç –Ω–∞ 30 –º–∏–Ω—É—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–µ—á–µ–Ω–∏–µ

3. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
   - –ö–æ–º–∞–Ω–¥–∞ `/diag_last` –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏–º–∏—Ç—ã –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è

4. **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞**:
   - –°–æ–∑–¥–∞—Ç—å –º–æ–º–µ–Ω—Ç –∏ –¥–æ–∂–¥–∞—Ç—å—Å—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–Ω –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ –ø–æ–∏—Å–∫–∞

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–°–∏—Å—Ç–µ–º–∞ "–ú–æ–º–µ–Ω—Ç—ã" —Å –ª–∏–º–∏—Ç–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞! 

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- üîí **–õ–∏–º–∏—Ç 2 –º–æ–º–µ–Ω—Ç–∞ –≤ –¥–µ–Ω—å** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚è≥ **TTL: 30/60/120 –º–∏–Ω—É—Ç** (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ)
- üßπ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞** –∏—Å—Ç–µ–∫—à–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤
- üìä **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ª–∏–º–∏—Ç–∞—Ö
- üß™ **–¢–µ—Å—Ç—ã** –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—ã—Å—Ç—Ä—ã—Ö –≤—Å—Ç—Ä–µ—á —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏!

---
*–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 2024*  
*–ê–Ω–∏–º–µ-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏—Ü–∞: —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –Ω–æ–≤—ã–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º! (‚óï‚Äø‚óï)‚ú®*
