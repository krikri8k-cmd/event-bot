# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –º–∏–≥—Ä–∞—Ü–∏–∏ 035

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

–ú–∏–≥—Ä–∞—Ü–∏—è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π. –ë–µ–∑ –Ω–µ—ë –∫–æ–¥ –±—É–¥–µ—Ç –ø–∞–¥–∞—Ç—å —Å –æ—à–∏–±–∫–æ–π:
```
column user_tasks.frozen_title does not exist
```

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—è

–î–æ–±–∞–≤–ª—è–µ—Ç 4 –Ω–æ–≤—ã—Ö –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—É `user_tasks`:
- `frozen_title` - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- `frozen_description` - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- `frozen_task_hint` - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞
- `frozen_category` - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è

## üöÄ –°–ø–æ—Å–æ–±—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Railway CLI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
railway run psql $DATABASE_URL < migrations/035_add_frozen_fields_to_user_tasks.sql
```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Python —Å–∫—Ä–∏–ø—Ç

```bash
python scripts/apply_sql.py migrations/035_add_frozen_fields_to_user_tasks.sql
```

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ psql –Ω–∞–ø—Ä—è–º—É—é

```bash
psql $DATABASE_URL -f migrations/035_add_frozen_fields_to_user_tasks.sql
```

### –°–ø–æ—Å–æ–± 4: –ß–µ—Ä–µ–∑ GitHub Actions (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω workflow)

1. –û—Ç–∫—Ä–æ–π GitHub Actions
2. –ù–∞–π–¥–∏ workflow "DB Apply"
3. –ó–∞–ø—É—Å—Ç–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º: `migrations/035_add_frozen_fields_to_user_tasks.sql`

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å:

```sql
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'user_tasks' 
AND column_name LIKE 'frozen%';
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 4 —Å—Ç—Ä–æ–∫–∏:
- frozen_title
- frozen_description
- frozen_task_hint
- frozen_category

## üîÑ –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

1. **–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è –≤ `database.py`:**
   - –°—Ç—Ä–æ–∫–∏ 98-101: —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å `frozen_*` –ø–æ–ª—è

2. **–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ `tasks_service.py`:**
   - –í `create_task_from_place()`: —Å—Ç—Ä–æ–∫–∏ —Å –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - –í `get_user_active_tasks()`: –ª–æ–≥–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞**

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –ú–∏–≥—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ADD COLUMN IF NOT EXISTS`, –ø–æ—ç—Ç–æ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –ü–æ–ª—è —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–∞–∫ `nullable=True`, –ø–æ—ç—Ç–æ–º—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã
- –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

